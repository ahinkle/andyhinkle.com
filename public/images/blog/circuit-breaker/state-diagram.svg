<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 700 320">
  <defs>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#64748b"/>
    </marker>
    <filter id="shadow" x="-20%" y="-20%" width="140%" height="140%">
      <feDropShadow dx="2" dy="2" stdDeviation="3" flood-opacity="0.15"/>
    </filter>
  </defs>

  <!-- Background -->
  <rect width="700" height="320" fill="#f8fafc"/>

  <!-- CLOSED State -->
  <g filter="url(#shadow)">
    <rect x="40" y="120" width="140" height="80" rx="12" fill="#22c55e"/>
    <text x="110" y="155" text-anchor="middle" fill="white" font-family="system-ui, sans-serif" font-weight="600" font-size="18">CLOSED</text>
    <text x="110" y="178" text-anchor="middle" fill="rgba(255,255,255,0.85)" font-family="system-ui, sans-serif" font-size="12">Normal operation</text>
  </g>

  <!-- OPEN State -->
  <g filter="url(#shadow)">
    <rect x="520" y="120" width="140" height="80" rx="12" fill="#ef4444"/>
    <text x="590" y="155" text-anchor="middle" fill="white" font-family="system-ui, sans-serif" font-weight="600" font-size="18">OPEN</text>
    <text x="590" y="178" text-anchor="middle" fill="rgba(255,255,255,0.85)" font-family="system-ui, sans-serif" font-size="12">Blocking requests</text>
  </g>

  <!-- HALF-OPEN State -->
  <g filter="url(#shadow)">
    <rect x="280" y="220" width="140" height="80" rx="12" fill="#f59e0b"/>
    <text x="350" y="255" text-anchor="middle" fill="white" font-family="system-ui, sans-serif" font-weight="600" font-size="18">HALF-OPEN</text>
    <text x="350" y="278" text-anchor="middle" fill="rgba(255,255,255,0.85)" font-family="system-ui, sans-serif" font-size="12">Testing recovery</text>
  </g>

  <!-- Arrow: CLOSED -> OPEN -->
  <path d="M 180 145 Q 350 80 520 145" stroke="#64748b" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
  <rect x="290" y="62" width="120" height="36" rx="6" fill="white" stroke="#e2e8f0" stroke-width="1"/>
  <text x="350" y="77" text-anchor="middle" fill="#64748b" font-family="system-ui, sans-serif" font-size="11">Failure threshold</text>
  <text x="350" y="91" text-anchor="middle" fill="#64748b" font-family="system-ui, sans-serif" font-size="11">exceeded</text>

  <!-- Arrow: OPEN -> HALF-OPEN -->
  <path d="M 545 200 Q 500 250 420 255" stroke="#64748b" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
  <rect x="460" y="218" width="100" height="36" rx="6" fill="white" stroke="#e2e8f0" stroke-width="1"/>
  <text x="510" y="233" text-anchor="middle" fill="#64748b" font-family="system-ui, sans-serif" font-size="11">Timeout</text>
  <text x="510" y="247" text-anchor="middle" fill="#64748b" font-family="system-ui, sans-serif" font-size="11">expires</text>

  <!-- Arrow: HALF-OPEN -> CLOSED (success) -->
  <path d="M 280 250 Q 180 250 135 200" stroke="#64748b" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
  <rect x="160" y="232" width="100" height="36" rx="6" fill="white" stroke="#e2e8f0" stroke-width="1"/>
  <text x="210" y="247" text-anchor="middle" fill="#22c55e" font-family="system-ui, sans-serif" font-size="11">Probe</text>
  <text x="210" y="261" text-anchor="middle" fill="#22c55e" font-family="system-ui, sans-serif" font-size="11">succeeds</text>

  <!-- Arrow: HALF-OPEN -> OPEN (failure) -->
  <path d="M 420 240 Q 500 200 540 200" stroke="#64748b" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>

  <!-- Self-loop on CLOSED for success -->
  <path d="M 60 120 Q 30 80 60 60 Q 90 40 120 60 Q 150 80 120 120" stroke="#64748b" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
  <rect x="55" y="28" width="90" height="22" rx="6" fill="white" stroke="#e2e8f0" stroke-width="1"/>
  <text x="100" y="43" text-anchor="middle" fill="#64748b" font-family="system-ui, sans-serif" font-size="11">Success</text>

  <!-- Label for HALF-OPEN -> OPEN -->
  <text x="485" y="188" text-anchor="middle" fill="#ef4444" font-family="system-ui, sans-serif" font-size="11">Probe fails</text>
</svg>